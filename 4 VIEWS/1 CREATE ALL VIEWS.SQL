
  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_KO_SEMIFINAL" ("MATCH_NO", "MATCH_WINNER_1", "TEAM_1", "MATCH_WINNER_2", "TEAM_2") AS 
  SELECT '61' AS MATCH_NO, '57 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 57) AS TEAM_1,
'58 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 58) AS TEAM_2
FROM DUAL

UNION

SELECT '62' AS MATCH_NO, '59 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 59) AS TEAM_1,
'60 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 60) AS TEAM_2
FROM DUAL

ORDER BY MATCH_NO;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_KO_RO16" ("MATCH_NO", "GROUP_WINNER", "TEAM_1", "RUNNER_UP", "TEAM_2") AS 
  SELECT '50' AS MATCH_NO, 'C1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_C WHERE RANK = 1) AS TEAM_1,
'D2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_D WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '49' AS MATCH_NO, 'A1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_A WHERE RANK = 1) AS TEAM_1,
'B2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_B WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '51' AS MATCH_NO, 'B1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_B WHERE RANK = 1) AS TEAM_1,
'A2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_A WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '52' AS MATCH_NO, 'D1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_D WHERE RANK = 1) AS TEAM_1,
'C2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_C WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '53' AS MATCH_NO, 'E1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_E WHERE RANK = 1) AS TEAM_1,
'F2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_F WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '54' AS MATCH_NO, 'G1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_G WHERE RANK = 1) AS TEAM_1,
'H2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_H WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '55' AS MATCH_NO, 'F1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_F WHERE RANK = 1) AS TEAM_1,
'E2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_E WHERE RANK = 2) AS TEAM_2
FROM DUAL

UNION

SELECT '56' AS MATCH_NO, 'H1' AS GROUP_WINNER, 
(SELECT NATION FROM VW_WORLDCUP_GROUP_H WHERE RANK = 1) AS TEAM_1,
'G2' AS RUNNER_UP,
(SELECT NATION FROM VW_WORLDCUP_GROUP_G WHERE RANK = 2) AS TEAM_2
FROM DUAL;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_FAIRPLAY" ("NATION", "WC_GROUP", "FP") AS 
  SELECT NATION, WC_GROUP, SUM(FP) AS FP
FROM WORLDCUP_CARDS
WHERE MATCH_NO <= 48
GROUP BY NATION, WC_GROUP
ORDER BY FP;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GOLDEN_BOOT" ("PLAYER", "NATION", "GOALS", "ASSISTS") AS 
  SELECT PLAYER, NATION, GOALS, ASSISTS
FROM WORLDCUP_PLAYERS
WHERE (GOALS <> 0 OR ASSISTS <> 0)
ORDER BY GOALS DESC, ASSISTS DESC;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_A" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, A."NATION",A."WIN",A."DRAW",A."LOSS",A."FP",A."GF",A."GA",A."GD",A."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'A'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) A;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_B" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, B."NATION",B."WIN",B."DRAW",B."LOSS",B."FP",B."GF",B."GA",B."GD",B."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'B'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) B;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_C" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, C."NATION",C."WIN",C."DRAW",C."LOSS",C."FP",C."GF",C."GA",C."GD",C."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'C'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) C;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_D" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, D."NATION",D."WIN",D."DRAW",D."LOSS",D."FP",D."GF",D."GA",D."GD",D."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'D'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) D;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_E" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, E."NATION",E."WIN",E."DRAW",E."LOSS",E."FP",E."GF",E."GA",E."GD",E."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'E'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) E;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_F" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, F."NATION",F."WIN",F."DRAW",F."LOSS",F."FP",F."GF",F."GA",F."GD",F."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'F'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) F;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_G" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, G."NATION",G."WIN",G."DRAW",G."LOSS",G."FP",G."GF",G."GA",G."GD",G."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'G'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) G;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_GROUP_H" ("RANK", "NATION", "WIN", "DRAW", "LOSS", "FP", "GF", "GA", "GD", "POINTS") AS 
  SELECT ROWNUM AS RANK, H."NATION",H."WIN",H."DRAW",H."LOSS",H."FP",H."GF",H."GA",H."GD",H."POINTS"
  FROM (SELECT WG.NATION, WG.WIN, WG.DRAW, WG.LOSS, FP.FP, WG.GF, WG.GA, WG.GD, POINTS FROM WORLDCUP_GROUPS WG, VW_WORLDCUP_FAIRPLAY FP
    WHERE ((WG.WC_GROUP = FP.WC_GROUP)
            AND (WG.NATION = FP.NATION))
    AND WG.WC_GROUP = 'H'
    ORDER BY POINTS DESC, GD DESC, GF DESC, FP DESC) H;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_KO_FINAL" ("MATCH_NO", "MATCH_WINNER_1", "TEAM_1", "MATCH_WINNER_2", "TEAM_2") AS 
  SELECT '64' AS MATCH_NO, '61 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 61) AS TEAM_1,
'62 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 62) AS TEAM_2
FROM DUAL

ORDER BY MATCH_NO;

  CREATE OR REPLACE FORCE VIEW "WORLDCUP"."VW_WORLDCUP_KO_QUARTERFINAL" ("MATCH_NO", "MATCH_WINNER_1", "TEAM_1", "MATCH_WINNER_2", "TEAM_2") AS 
  SELECT '57' AS MATCH_NO, '49 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 49) AS TEAM_1,
'50 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 50) AS TEAM_2
FROM DUAL

UNION

SELECT '58' AS MATCH_NO, '53 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 53) AS TEAM_1,
'54 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 54) AS TEAM_2
FROM DUAL

UNION

SELECT '60' AS MATCH_NO, '55 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 55) AS TEAM_1,
'56 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 56) AS TEAM_2
FROM DUAL

UNION

SELECT '59' AS MATCH_NO, '51 WINNER' AS MATCH_WINNER_1, 
(SELECT 
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 51) AS TEAM_1,
'52 WINNER' AS MATCH_WINNER_2,
(SELECT
CASE
    WHEN TEAM_1_SCORE > TEAM_2_SCORE
        THEN TEAM_1 
    WHEN TEAM_1_SCORE < TEAM_2_SCORE
        THEN TEAM_2
    WHEN TEAM_1_SCORE = TEAM_2_SCORE
        THEN PK_WINNER
    ELSE NULL    
    END 
FROM WORLDCUP_MATCHES WHERE MATCH_NO = 52) AS TEAM_2
FROM DUAL

ORDER BY MATCH_NO;
